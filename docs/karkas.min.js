!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(){this._version="4.0.0",this.views=new Map,this.filters=new Map}return Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.views.clear()},e.prototype.getView=function(e){if(this.views.has(e))throw new ReferenceError("Karkas: View '"+e+"' is not defined");return this.views.get(e)},e.prototype.getFilter=function(e){if(this.filters.has(e))throw new ReferenceError("Karkas: Filter '"+e+"' is not defined");return this.filters.get(e)},e.prototype.filter=function(e,t){var r=e.trim().split(":"),n=e[0];if(t=[t],r.length>1){var o=new Function("return ["+e[1].trim()+"]")();t=t.concat(o)}if(this.filters.has(n))throw new ReferenceError("Karkas: filter '"+n+"' is not defined");try{var i=this.filters.get(n);return i.apply(i,t)}catch(e){throw new Error("Karkas: failed to apply filter '"+n+"', reason: "+e.message)}},e.prototype.compile=function(e,t){void 0===t&&(t={});var r=this.getView(e);return t instanceof Array?r.parseArray(t):r.parse(t)},e.prototype.createView=function(e,t){var r=new n.View(this,e,t);return this.views.set(e,r),r},e.prototype.addFilter=function(e,t){return this.filters.set(e,t),this},e}();t.Karkas=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(3),i=function(){var e=null;return"undefined"!=typeof window?void 0===window.karkas?(e=new o.KarkasDOM,window.karkas=e):e=window.karkas:e=new n.Karkas,e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/[\{\{](.*?)[\}\}]+/gim,o=function(e){return new Function("with(this) { return "+e+"; }")},i=function(e,t){return typeof e===t},s=function(e){return i(e,"undefined")},a=function(){function e(e,t,r){if(void 0===r&&(r=null),this.handler=e,this.name=null,this.content=null,"string"!=typeof r)throw new ReferenceError("Karkas.View: Template content must be a string");this.name=t,this.content=r.trim()}return Object.defineProperty(e.prototype,"pattern",{get:function(){return n},enumerable:!0,configurable:!0}),e.prototype.parseExpression=function(e,t){return o(t).apply(e)},e.prototype.parse=function(e){var t=this.content.toString(),r=t.match(this.pattern);for(var n in r){var o=r[n];if(i(o,"string")||i(o,"number")){var a=o.replace("{{","").replace("}}","").trim().split("|"),u=a.length>1?a[a.length-1]:void 0,c=a[0],f=void 0;try{f=this.parseExpression(e,c)}catch(e){throw new ReferenceError("Karkas: failed to parse expression '"+c+"' in template '"+this.name+"'. "+e.message)}s(f)||(f=""),s(u)&&(f=this.handler[this.handler.views.has(u)?"compile":"filter"](u,f)),t=t.replace(o,f)}}return t},e.prototype.parseArray=function(e){var t=this;return e.map(function(e){return t.parse(e)}).join()},e}();t.View=a},function(e,t,r){"use strict";function n(e){return void 0!==e}function o(e){return null===e}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),a=function(e){return console.error(e)},u=function(e){function t(){var t=e.call(this)||this;if(!n(window))throw new ReferenceError("Karkas DOM extensions requries browser");if(!n(window.document))throw new Error("Karkas DOM extensions requires a document object");return document.addEventListener("DOMContentLoaded",function(){return t.refresh}),t}return i(t,e),t.prototype.onFind=function(){},t.prototype.compileElement=function(e){var t=e.getAttribute("data-view"),r=e.getAttribute("data-compile");if(o(t))throw new ReferenceError("data-view is undefined");if(o(r))throw new ReferenceError("data-compile is undefined");t=t.trim(),r=r.trim();try{r=JSON.parse(r),e.innerHTML+=this.compile(t,r)}catch(t){console.error("Karkas: failed to compile element",{element:e,error:t})}},t.prototype.refresh=function(e){e&&this.dispose();var t='script[type="text/karkas"]';e||(t+=":not([data-loaded])");for(var r=document.querySelectorAll(t),n=0;n<r.length;n++)this.createView(r[n].getAttribute("name"),r[n].innerHTML);var o=document.querySelectorAll("*[data-compile]");if(!o.length)return!0;for(var i=0;i<o.length;i++)this.compileElement(o[i]);"function"==typeof this.onFind&&this.onFind()},t.prototype.include=function(e,t,r){function o(r,o){var i=this;void 0===o&&(o=a);var s=new XMLHttpRequest;s.open("GET",e),s.onload=function(){if(s.status>=200&&s.status<300){var e=i.createView(t,s.response);r(e,s.response)}else o({status:i.status,statusText:s.statusText})},s.onerror=function(){n(o)?o({status:s.status,statusText:s.statusText}):console.error("Karkas: Failed to import remote template: ",{status:s.status,statusText:s.statusText})},s.send()}if(void 0===r&&(r=null),"string"!=typeof e)throw new ReferenceError("Karkas: Url is not a String");return t=t||e,"function"!=typeof r&&"Promise"in window?new Promise(o):o(r)},t}(s.Karkas);t.KarkasDOM=u}]);
//# sourceMappingURL=karkas.min.map