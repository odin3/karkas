/**
  * KarkasJS 
  * @author Denis Sedchenko (https://github.com/odin3/karkasJS)
  * @version 2.0.3
  */
var karkas={views:[],version:"2.0.3",findAll:function(){this.views=[];for(var e=document.querySelectorAll("template"),t=0;t<e.length;t++)this.views[e[t].getAttribute("name")]=new karkasView(e[t])},compile:function(e,t,n,r){function a(e){return r?e.innerHTML=s:e.innerHTML+=s,s}var s="",i=this.getView(e);if(n=n||!1,r=r||!1,s=t instanceof Array?i.parseArray(t):i.parse(t),0==n)return s;if(n instanceof HTMLElement)return a(n);"string"==typeof n&&(n=document.querySelectorAll(n));for(var o=0;o<n.length;o++)a(n[o]);return s},include:function(e){return 0==document.querySelectorAll("karkas").length&&document.getElementsByTagName("body")[0].appendChild(document.createElement("karkas")),new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.onload=function(){this.status>=200&&this.status<300?(document.querySelector("karkas").innerHTML+=r.response,karkas.findAll(),t(r.response)):n({status:this.status,statusText:r.statusText})},r.onerror=function(){n({status:this.status,statusText:r.statusText})},r.send()})},getView:function(e){if("undefined"==typeof karkas.views[e])throw new ReferenceError("[KarkasView] Requested template is not defined: '"+e+"'");return karkas.views[e]}},karkasView=function(e){this.name=e.getAttribute("name")||"",this.selector="template[name='"+this.name+"']",this.element=e};karkasView.prototype={pattern:/[{{](\S*)[}}]+/gim,getContext:function(){return this.element.innerHTML},parse:function(e){var t=this.getContext(),n=t.match(this.pattern);for(var r in n)if("string"==typeof n[r]||"number"==typeof n[r]){var a=n[r].replace("{{","").replace("}}",""),s="";"this"==a&&"object"!=typeof e?s=e:"undefined"!=typeof e[a]&&(s=e[a.toString()].toString()),t=t.replace(n[r],s)}return t},parseArray:function(e){for(var t="",n=0;n<e.length;n++)t+=this.parse(e[n]);return t}},function(){document.createElement("template"),document.createElement("karkas");var e="template,karkas{display: none;}",t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}();
