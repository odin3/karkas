/**
  * KarkasJS 
  * @author Denis Sedchenko (https://github.com/odin3/karkasJS)
  * @version 2.1.7
  */
var karkas={views:[],version:"2.1.7",autorun:!0,params:{parseAsObject:!1,allowTemplatesTag:!1,replaceUndefinedExpressions:!0},findAll:function(){this.views=[];var e="script[type='template/karkas']";this.params.allowTemplatesTag&&(e+=" ,template");for(var t=document.querySelectorAll(e),a=0;a<t.length;a++)this.views[t[a].getAttribute("name")]=new karkasView(t[a])},compile:function(e,t,a,n){function r(e){return n?e.innerHTML=s:e.innerHTML+=s,s}var s="",i=this.getView(e);if(a=a||!1,n=n||!1,s=t instanceof Array?i.parseArray(t):i.parse(t),0==a)return s;if("undefined"!=typeof jQuery&&a instanceof jQuery){if(!(a.length>0))return s;a=a.get(0)}if(a instanceof HTMLElement)return r(a);"string"==typeof a&&(a=document.querySelectorAll(a));for(var l=0;l<a.length;l++)r(a[l]);return s},include:function(e){return 0==document.querySelectorAll("karkas").length&&document.getElementsByTagName("body")[0].appendChild(document.createElement("karkas")),new Promise(function(t,a){var n=new XMLHttpRequest;n.open("GET",e),n.onload=function(){this.status>=200&&this.status<300?(document.querySelector("karkas").innerHTML+=n.response,karkas.findAll(),t(n.response)):a({status:this.status,statusText:n.statusText})},n.onerror=function(){a({status:this.status,statusText:n.statusText})},n.send()})},getView:function(e){if("undefined"==typeof karkas.views[e])throw new ReferenceError("KarkasJS: Requested template is not defined: '"+e+"'");return karkas.views[e]}},karkasView=function(e){if(null==e.getAttribute("name")||0==e.getAttribute("name").length)throw new ReferenceError("KarkasJS: Template element must have a name");this.name=e.getAttribute("name")||"",this.element=e,this.selector=this.element.tagName.toLowerCase()+"[name='"+this.name+"']"};karkasView.prototype={pattern:/[{{](\S*)[}}]+/gim,getContext:function(){return this.element.innerHTML},parse:function(fields){var sReturn=this.getContext(),tpFields=sReturn.match(this.pattern);for(var pat in tpFields)if("string"==typeof tpFields[pat]||"number"==typeof tpFields[pat]){var key=tpFields[pat].replace("{{","").replace("}}",""),newVal="";"this"==key&&"object"!=typeof fields?newVal=fields:(newVal=eval(karkas.params.parseAsObject?"fields."+key:'fields["'+key.split(".").join('"]["')+'"]'),"undefined"==typeof newVal&&1==replaceUndefinedExpressions&&(newVal="")),sReturn=sReturn.replace(tpFields[pat],newVal)}return sReturn},parseArray:function(e){for(var t="",a=0;a<e.length;a++)t+=this.parse(e[a]);return t}},function(){document.createElement("template"),document.createElement("karkas");var e=1==karkas.params.allowTemplatesTag?"template,karkas{display: none;}":"karkas{display: none;}",t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e)),t.appendChild(a),karkas.autorun&&karkas.findAll()}();
