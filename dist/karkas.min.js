!function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=function(){function e(){this._version="4.0.0",this.views=new Map,this.filters=new Map}return Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.views.clear()},e.prototype.getView=function(e){if(!this.views.has(e))throw new ReferenceError("Karkas: View '"+e+"' is not defined");return this.views.get(e)},e.prototype.getFilter=function(e){if(!this.filters.has(e))throw new ReferenceError("Karkas: Filter '"+e+"' is not defined");return this.filters.get(e)},e.prototype.filter=function(e,t){var r=e.trim().split(":"),n=r[0];if(t=[t],r.length>1){var i=new Function("return ["+r[1].trim()+"]")();t=t.concat(i)}if(!this.filters.has(n))throw new ReferenceError("Karkas: filter '"+n+"' is not defined");try{var o=this.filters.get(n);return o.apply(o,t)}catch(e){throw new Error("Karkas: failed to apply filter '"+n+"', reason: "+e.message)}},e.prototype.compile=function(e,t){void 0===t&&(t={});var r=this.getView(e);return t instanceof Array?r.parseArray(t):r.parse(t)},e.prototype.createView=function(e,t){var r=new n.View(this,e,t);return this.views.set(e,r),r},e.prototype.addFilter=function(e,t){return this.filters.set(e,t),this},e}();t.Karkas=i},function(e,t,r){"use strict";function n(e,t){try{var r=[].splice.apply(arguments,[2]);return[][t].apply(e,r)}catch(e){throw new Error("Failed to perform method `Array."+t+"` ("+e.message+")")}}Object.defineProperty(t,"__esModule",{value:!0}),t.arrayFilter=n},function(e,t,r){"use strict";function n(e){return e=String(e),e.substring(0,1).toUpperCase()+e.substring(1)}Object.defineProperty(t,"__esModule",{value:!0}),t.capitalizeFilter=n},function(e,t,r){"use strict";function n(e,t,r){return void 0===t&&(t="$"),(t=t||"$")+" "+function(e,t,r,n){var t=isNaN(t=Math.abs(t))?2:t,r=void 0==r?".":r,n=void 0==n?",":n,i=e<0?"-":"",o=parseInt(e=Math.abs(+e||0).toFixed(t))+"",a=(a=o.length)>3?a%3:0;return i+(a?o.substr(0,a)+n:"")+o.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+n)+(t?r+Math.abs(e-o).toFixed(t).slice(2):"")}(e,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.currencyFilter=n},function(e,t,r){"use strict";function n(e){try{return JSON.stringify(e)}catch(t){return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.jsonFilter=n},function(e,t,r){"use strict";function n(e,t){try{return[].splice.apply(arguments,[1,1]),Math[t].apply(Math,arguments)}catch(e){throw new Error("Failed to perform method `Math."+t+"` ("+e.message+")")}}Object.defineProperty(t,"__esModule",{value:!0}),t.mathFilter=n},function(e,t,r){"use strict";function n(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];try{return String.prototype[t].apply(e,r)}catch(e){throw new Error("Failed to perform method 'String."+t+"' ("+e.message+")")}}Object.defineProperty(t,"__esModule",{value:!0}),t.stringFilter=n},function(e,t,r){"use strict";function n(e){return String(e).toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),t.toLowerFilter=n},function(e,t,r){"use strict";function n(e){return String(e).toUpperCase()}Object.defineProperty(t,"__esModule",{value:!0}),t.toUpperFilter=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(11),o=r(12),a=function(){var e=null;return"undefined"!=typeof window?void 0===window.karkas?(e=new i.KarkasDOM,window.karkas=e):e=window.karkas:e=new n.Karkas,o.injectDefaultFilters(e),e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/[\{\{](.*?)[\}\}]+/gim,i=function(e){return new Function("with(this) { return "+e+"; }")},o=function(e,t){return typeof e===t},a=function(e){return!o(e,"undefined")},s=function(){function e(e,t,r){if(void 0===r&&(r=null),this.handler=e,this.name=null,this.content=null,"string"!=typeof r)throw new ReferenceError("Karkas.View: Template content must be a string");this.name=t,this.content=r.trim()}return Object.defineProperty(e.prototype,"pattern",{get:function(){return n},enumerable:!0,configurable:!0}),e.prototype.parseExpression=function(e,t){return i(t).apply(e)},e.prototype.parse=function(e){var t=this.content.toString(),r=t.match(this.pattern);for(var n in r){var i=r[n];if(o(i,"string")||o(i,"number")){var s=i.replace("{{","").replace("}}","").trim().split("|"),u=s.length>1?s[s.length-1]:void 0,c=s[0],l=void 0;try{l=this.parseExpression(e,c)}catch(e){throw new ReferenceError("Karkas: failed to parse expression '"+c+"' in template '"+this.name+"'. "+e.message)}a(l)||(l=""),a(u)&&(l=this.handler[this.handler.views.has(u)?"compile":"filter"](u,l)),t=t.replace(i,l)}}return t},e.prototype.parseArray=function(e){var t=this;return e.map(function(e){return t.parse(e)}).join("")},e}();t.View=s},function(e,t,r){"use strict";function n(e){return void 0!==e}function i(e){return null===e}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=function(e){return console.error(e)},u=function(e){function t(){var t=e.call(this)||this;if(!n(window))throw new ReferenceError("Karkas DOM extensions requries browser");if(!n(window.document))throw new Error("Karkas DOM extensions requires a document object");return document.addEventListener("DOMContentLoaded",function(){return t.refresh()}),t}return o(t,e),t.prototype.onFind=function(){},t.prototype.compileElement=function(e){var t=e.getAttribute("data-view"),r=e.getAttribute("data-compile");if(i(t))throw new ReferenceError("data-view is undefined");if(i(r))throw new ReferenceError("data-compile is undefined");t=t.trim(),r=r.trim();try{r=JSON.parse(r),e.innerHTML+=this.compile(t,r)}catch(t){console.error("Karkas: failed to compile element",{element:e,error:t})}},t.prototype.refresh=function(e){void 0===e&&(e=!0),e&&this.dispose();var t='script[type="text/karkas"]';e||(t+=":not([data-loaded])");for(var r=document.querySelectorAll(t),n=0;n<r.length;n++)this.createView(r[n].getAttribute("name"),r[n].innerHTML);var i=document.querySelectorAll("*[data-compile]");if(!i.length)return!0;for(var o=0;o<i.length;o++)this.compileElement(i[o]);"function"==typeof this.onFind&&this.onFind()},t.prototype.include=function(e,t,r){function i(r,i){var o=this;void 0===i&&(i=s);var a=new XMLHttpRequest;a.open("GET",e),a.onload=function(){if(a.status>=200&&a.status<300){var e=o.createView(t,a.response);r(e,a.response)}else i({status:o.status,statusText:a.statusText})},a.onerror=function(){n(i)?i({status:a.status,statusText:a.statusText}):console.error("Karkas: Failed to import remote template: ",{status:a.status,statusText:a.statusText})},a.send()}if(void 0===r&&(r=null),"string"!=typeof e)throw new ReferenceError("Karkas: Url is not a String");return t=t||e,"function"!=typeof r&&"Promise"in window?new Promise(i):i(r)},t}(a.Karkas);t.KarkasDOM=u},function(e,t,r){"use strict";function n(e){e.addFilter("currency",a.currencyFilter).addFilter("string",c.stringFilter).addFilter("array",i.arrayFilter).addFilter("math",u.mathFilter).addFilter("json",s.jsonFilter).addFilter("capitalize",o.capitalizeFilter).addFilter("toLower",l.toLowerFilter).addFilter("toUpper",p.toUpperFilter)}Object.defineProperty(t,"__esModule",{value:!0});var i=r(1),o=r(2),a=r(3),s=r(4),u=r(5),c=r(6),l=r(7),p=r(8),f=r(1);t.arrayFilter=f.arrayFilter;var d=r(2);t.capitalizeFilter=d.capitalizeFilter;var h=r(3);t.currencyFilter=h.currencyFilter;var y=r(4);t.jsonFilter=y.jsonFilter;var w=r(5);t.mathFilter=w.mathFilter;var v=r(6);t.stringFilter=v.stringFilter;var m=r(7);t.toLowerFilter=m.toLowerFilter;var F=r(8);t.toUpperFilter=F.toUpperFilter,t.injectDefaultFilters=n}]);
//# sourceMappingURL=karkas.min.map